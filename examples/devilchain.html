<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Necklace Viewer</title>
<link rel="stylesheet" href="./style.css">

<style>
#info {
	position: absolute;
	top: 0px;
	padding: 10px;
	box-sizing: border-box;
	text-align: center;
	-moz-user-select: none;
	-webkit-user-select: none;
	-ms-user-select: none;
	user-select: none;
	pointer-events: none;
	z-index: 1; /* TODO Solve this in HTML */
		right: auto;
		top: auto;
		max-height: 50%;
		max-width: 40%;
		bottom: 0;
		right: 0;
		width:300px;
		font-family: bob;
}





@font-face {
    font-family: Alcohole;
    src: url(Mousedrawn.otf);
}



@font-face {
    font-family: bob;
    src: url(bob.ttf);
}

#caption {
	font-family: bob;
}

.bg {

display:none;
position:absolute; z-index:-1; top:0; left:0; width:100vw; height:100vh; 
  background-repeat: no-repeat;
  background-size: 100% 100%;
}

.extra {
	font-family: Alcohole;
	display:none;
position:absolute; z-index:99; top:0; left:0; width:100vw; height:100vh; 
}

p {
	padding:5px;
	      mix-blend-mode: exclusion;
		font-family: Alcohole;
		color:#cccccc;
		text-shadow: 2.5px 0 0 #000, 0 -2.5px 0 #000, 0 2.5px 0 #000, -2.5px 0 0 #000;
	font-size:18px;
	text-align:center;
}

body > canvas {


	height:100vh;
	width:100vw;
	z-index:0;
}
</style>
</head>
<body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://unpkg.com/three@0.138.2/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.135.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://unpkg.com/three@0.138.2/examples/jsm/postprocessing/EffectComposer.js"></script>
<script src="https://unpkg.com/three@0.135.0/examples/jsm/postprocessing/RenderPass.js"></script>
<script src="https://unpkg.com/three@0.135.0/examples/jsm/postprocessing/ShaderPass.js"></script>
<script src="https://unpkg.com/three@0.135.0/examples/jsm/postprocessing/OutlinePass.js"></script>
<script src="https://unpkg.com/three@0.135.0/examples/jsm/shaders/FXAAShader.js"></script>

<script src="../dist/camera-controls.js"></script>
<script>


CameraControls.install( { THREE: THREE } );
let INTERSECTED;
let INTERSECTED_click;
let theta = 0;
let disableAutoRotate = true;
var necklace;
var selector;
const radius = 100;
const width  = window.innerWidth;
const height = window.innerHeight;
const clock = new THREE.Clock();
const scene  = new THREE.Scene();
const pointer = new THREE.Vector2();
const camera = new THREE.PerspectiveCamera( 60, width / height, 0.01, 1000 );
camera.position.set( 0, 1, 6);
camera.rotation.set( 0, 0, 0);
const  renderer = new THREE.WebGLRenderer( { antialias: true, alpha:true } );
renderer.setSize( width, height );
renderer.outputEncoding = THREE.sRGBEncoding;
document.body.appendChild( renderer.domElement );
document.addEventListener( 'mousemove', onPointerMove );
	document.addEventListener( 'mousedown', onDocumentMouseDown, false );

const cameraControls = new CameraControls( camera, renderer.domElement );
const light = new THREE.PointLight( 0xff0000, 1, 100 );
scene.add(
	new THREE.HemisphereLight( 0x443333, 0x332222 ),
	new THREE.AmbientLight( 0xf7f7f7 ),
);

raycaster = new THREE.Raycaster();

new THREE.GLTFLoader().load( './devilchain.glb', function ( gltf ) {

	gltf.scene.scale.set(.1, .1, .1);

	  gltf.scene.traverse( function ( child ) {
        if ( child.isMesh ) {

        		var model = child;
		

        }
       });




	necklace = gltf.scene;

	scene.add( necklace );




	renderer.render( scene, camera );

} 


);



	function onPointerMove( event ) {

scene.updateMatrixWorld();
				pointer.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				pointer.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

			
	raycaster.setFromCamera( pointer, camera );

				const intersects = raycaster.intersectObjects( necklace.children, true);



				if ( intersects.length > 0 ) {

					if ( INTERSECTED != intersects[ 0 ].object ) {

						

						INTERSECTED = intersects[ 0 ].object;

							

						 document.documentElement.style.cursor = "pointer";

					
						//INTERSECTED.material.roughness = 1;	

						//cant figure out what to do here to highlight hovered
										}

				} else {


					INTERSECTED = null;

						 document.documentElement.style.cursor = "auto";

		


				}


			}


	function onDocumentMouseDown( event ) 
{

	console.log(camera.position);
	console.log(camera.rotation);

	scene.updateMatrixWorld();
				pointer.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				pointer.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

			
	raycaster.setFromCamera( pointer, camera );

				const intersects_click = raycaster.intersectObjects( necklace.children, true);



				if ( intersects_click.length > 0 ) {



					if ( INTERSECTED_click != intersects_click[ 0 ].object ) {

					
						$(".bg").fadeOut();	
						$(".extra").fadeOut();	



						INTERSECTED_click = intersects_click[ 0 ].object;

							var selector = '#' + INTERSECTED_click.name;
						
						$(selector).fadeIn();	


						var selector_2 = '#' + INTERSECTED_click.name + "2";
						console.log(selector_2);
						$(selector_2).fadeIn();
						
						cameraControls.fitToSphere( INTERSECTED_click, true );
					
						disableAutoRotate = false;

						document.getElementById("caption").innerHTML = INTERSECTED.name;

						

					}

				} else {

						$(".bg").fadeOut();	
							$(".extra").fadeOut();	


					INTERSECTED_click = null;

				
						document.getElementById("caption").innerHTML = "";

					disableAutoRotate = true;
     
					cameraControls.reset(true);


				}



}



( function anim () {

	const delta = clock.getDelta();
	const elapsed = clock.getElapsedTime();
	const updated = cameraControls.update( delta );

		if ( ! disableAutoRotate ) {

		cameraControls.azimuthAngle += 20 * delta * THREE.MathUtils.DEG2RAD;

	}

	// if ( elapsed > 30 ) { return; }

	requestAnimationFrame( anim );

	if ( updated ) {



		renderer.render( scene, camera );
	

	}

} )();





const _box = new THREE.Box3();
const _vec3 = new THREE.Vector3();



</script>

<div style="background-image: url('croppedwolf.jpg')"
id="croppedwolf" class="bg">

</div>

<div class="extra" id="croppedwolf2">

		<p><i>This dog tried to bust out of his cage and was memorialized in a frame for his determination</i></p>


</div>


<div style="background-image: url('apple.jpeg')"
id="fg_appleShape00_Untitled004" class="bg">

</div>

<div class="extra" id="fg_appleShape00_Untitled0042">

	<p><i>looks tasty...</i></p>


</div>

<div style="background-image: url('Handle1004.png')"
id="Handle1" class="bg">
</div>


<div class="extra" id="Handle12">


	<p><i>planet Handle1 was like Earth but with a slight adjustment to the carbon molecule...</i></p>

</div>



<div style="background-image: url('devilmancroped006.jpeg')"
id="devilmancroped021" class="bg">
</div>


<div class="extra" id="devilmancroped0212">

	<p><i>an image of the devil, from aerial surveillance of hell...</i></p>


</div>


<div style="background-image: url('devilmancroped007.jpeg')"
id="devilmancroped007" class="bg">
</div>


<div class="extra" id="devilmancroped0072">

	<p><i>an image of the devil, from aerial surveillance of hell...</i></p>


</div>


<div style="background-image: url('bullcroped004.jpeg')"
id="bullcroped004" class="bg">
</div>


<div class="extra" id="bullcroped0042">

	<p><i>bullcroped004 was a bull joined with a dog in a rockslide and unfortunately stretched out...</i></p>


</div>


<div style="background-image: url('shepherd010.jpeg')"
id="shepherd010" class="bg">
</div>


<div class="extra" id="shepherd0102">

	<p><i>a misprint, not the real shepherd, with a malformed personality</i></p>


</div>
<div style="background-image: url('shepherd010.jpeg')"
id="shepherd001" class="bg">
</div>


<div class="extra" id="shepherd0012">

	<p><i>a misprint, not the real shepherd, with a malformed personality</i></p>


</div>


<div style="background-image: url('mondonuevo003.jpeg')"
id="mondonuevo003" class="bg">
</div>


<div class="extra" id="mondonuevo0032">

	<p><i>Mondonuevo003 was an artifact formed by twin idols cast together in stone by a chemical reaction</i></p>


</div>

<div style="background-image: url('Muszla3P_250.jpeg')"
id="Muszla3P_250018_1" class="bg">
</div>


<div class="extra" id="Muszla3P_250018_12">

	<p><i>Muszla3P_250018_12 was an artifact necklace found in an urn buried underneath a city block. While evidence suggests a modern origin for the piece, the individual components are much older...</i></p>


</div>

<div style="background-image: url('Muszla3P_250.jpeg')"
id="Muszla3P_250018_2" class="bg">
</div>


<div class="extra" id="Muszla3P_250018_22">

	<p><i>Muszla3P_250018_12 was an artifact necklace found in an urn buried underneath a city block. While evidence suggests a modern origin for the piece, the individual components are much older...</i></p>


</div>



<div style="background-image: url('devilmancroped3.jpg')"
id="devilmancroped004" class="bg">
</div>


<div class="extra" id="devilmancroped0042">

	<p><i>an image of the devil, from the 4th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped4.png')"
id="devilmancroped005" class="bg">
</div>


<div class="extra" id="devilmancroped0052">

	<p><i>an image of the devil, from the 5th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped7.jpg')"
id="devilmancroped014" class="bg">
</div>


<div class="extra" id="devilmancroped0142">

	<p><i>an image of the devil, from the 14th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped8.jpg')"
id="devilmancroped015" class="bg">
</div>


<div class="extra" id="devilmancroped0152">

	<p><i>an image of the devil, from the 15th circle of hell.</i></p>


</div>


<div style="background-image: url('devilmancroped10.png')"
id="devilmancroped020" class="bg">
</div>


<div class="extra" id="devilmancroped0202">

	<p><i>an image of the devil, from the 20th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped11.jpg')"
id="devilmancroped011" class="bg">
</div>


<div class="extra" id="devilmancroped0112">

	<p><i>an image of the devil, from the 11th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped12.png')"
id="devilmancroped010" class="bg">
</div>


<div class="extra" id="devilmancroped0102">

	<p><i>an image of the devil, from the 10th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped13.jpg)"
id="devilmancroped009" class="bg">
</div>


<div class="extra" id="devilmancroped0092">

	<p><i>an image of the devil, from the 9th circle of hell.</i></p>


</div>

<div style="background-image: url('devilmancroped14.jpg)"
id="devilmancroped016" class="bg">
</div>


<div class="extra" id="devilmancroped0162">

	<p><i>an image of the devil, from the 16th circle of hell.</i></p>


</div>

004
005
014
015
020
011
010
009
016


<div style="background-image: url('odd.jpg')"
id="chain" class="bg">
</div>

<div style="background-image: url('odd.jpg')"
id="chain_2" class="bg">
</div>


<div style="background-image: url('odd.jpg')"
id="chain_3" class="bg">
</div>


<div style="background-image: url('odd.jpg')"
id="chain_4" class="bg">
</div>

<div style="background-image: url('odd.jpg')"
id="chain_5" class="bg">
</div>

<div style="position:absolute; text-shadow: 1px 0 0 #000, 0 -1px 0 #000, 0 1px 0 #000, -1px 0 0 #000; bottom:5px; left:10px; font-size:34px; 	color:#cccccc;"

id="caption">

</div>

		<div id="info">
	"DEVIL CHAIN"
	<br>
	Necklace Characteristics:
	<br>
	<i>guile, luck, money<i>
		<br>
		<i>chthonic, potency, disaster-proof</i>
		</div>


</body>
</html>
